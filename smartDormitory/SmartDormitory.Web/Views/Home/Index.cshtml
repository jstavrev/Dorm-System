@model List<IndexViewModel>
@{
    ViewData["Title"] = "Home Page";
}

<style>

    #map {
        height: 500px;
        width: 900px;
    }

    html, body {
        height: 100%;
        margin: 0;
        padding: 0;
    }
</style>
<br />
<br />
<br />
<br />
<div class="row">
    <div id="map"></div>
    <script src="~/lib/marker-clusterer/marker-cluster.js"></script>
    <script>
        var map;
        function initMap() {
            map = new google.maps.Map(document.getElementById('map'), {
                center: { lat: 42.694, lng: 23.312 },
                zoom: 8
            });

            let markers = [];

            @foreach(var item in Model)
             {
                @:var marker = new google.maps.Marker({
                @:position: { lng: @item.Longitude, lat: @item.Latitude  },
                @: map: map
                @:});

               @: var infowindow = new google.maps.InfoWindow({
               @:content: 'na ioan senzora'
               @:});


                @: marker.addListener('click', function() {
                @: infowindow.open(map, marker);
                @:});

                @:markers.push(marker);
            };  
            console.log(markers)
            let markerCluster = new MarkerClusterer(map, markers);

        }
    </script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCDteKY2bbicMlrP2DHSJmSciuIP-E_D6k&callback=initMap"
            async defer></script>
</div>
